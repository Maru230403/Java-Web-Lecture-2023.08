<%@ page language="java" contentType="text/html; charset=UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Kakao Map Example</title>
    <!-- 카카오 맵 API 스크립트 추가 -->
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=48ebc9d0984753af19dbe3b02dca2b48"></script>
</head>
<body>

<!-- 지도를 표시할 div 요소 -->
<div id="map" style="width:100%;height:400px;"></div>

<!-- 출발지와 도착지 좌표 -->
<input type="hidden" id="startLat" value="37.5665">
<input type="hidden" id="startLng" value="126.9780">
<input type="hidden" id="endLat" value="37.5665"> <!-- 도착지 좌표 설정 -->
<input type="hidden" id="endLng" value="126.9780"> <!-- 도착지 좌표 설정 -->

<!-- 거리 계산 결과를 표시할 div 요소 -->
<div id="distance"></div>

<!-- 카카오 맵 초기화 스크립트 -->
<script>
    // API 키 설정
    kakao.maps.load(() => {
        // 출발지와 도착지 좌표
        const startLat = parseFloat(document.getElementById('startLat').value);
        const startLng = parseFloat(document.getElementById('startLng').value);
        const endLat = parseFloat(document.getElementById('endLat').value);
        const endLng = parseFloat(document.getElementById('endLng').value);

        // 지도 생성
        const mapContainer = document.getElementById('map');
        const options = {
            center: new kakao.maps.LatLng(startLat, startLng), // 출발지 좌표로 설정
            level: 10 // 지도 확대 레벨
        };
        const map = new kakao.maps.Map(mapContainer, options);

        // 마커 생성
        const startMarker = new kakao.maps.Marker({
            position: new kakao.maps.LatLng(startLat, startLng),
            map: map
        });

        const endMarker = new kakao.maps.Marker({
            position: new kakao.maps.LatLng(endLat, endLng),
            map: map
        });

        // 거리 계산
        const distance = kakao.maps.services.Distance;
        const request = {
            origins: new kakao.maps.LatLng(startLat, startLng),
            destinations: new kakao.maps.LatLng(endLat, endLng)
        };

        distance.route(request, (result, status) => {
            if (status === kakao.maps.services.Status.OK) {
                const resultDiv = document.getElementById('distance');
                resultDiv.innerHTML = '거리: ' + result.routes[0].distance.text;
            }
        });
    });
</script>

</body>
</html>
